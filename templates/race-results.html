{% extends "base.html" %}
{% import "section-header.html" as sh %}
{% block content %}

{{ sh.section_header(race.race_name + " - Race") }}

<section class="flex flex-col justify-center">
    <table class="text-xs table-fixed mx-auto text-left" style="border-collapse: separate;
    border-spacing: 12px 3px;">
        <thead>
            <tr>
                <th>Pos</th>
                <th>Driver</th>
                <th>Constructor</th>
                <th>Grid Pos</th>
                <th>Laps</th>
                <th>Fastest Lap</th>
                <!-- <th>Interval</th> -->
                <th>Status</th>
                <th>Points</th>
            </tr>
        </thead>
        <tbody>
            {% for d in race.results %}
            <tr>
                <td>{{d.position}}</td>
                <td>
                    <a href="{{url_for('driver', driver_id=d.driver.driver_id)}}">
                        {{d.driver.given_name + " " + d.driver.family_name}}
                    </a>
                </td>
                <td><a
                        href="{{url_for('constructor', constructor_id=d.constructor.constructor_id)}}">{{d.constructor.name}}</a>
                </td>

                {% if d.grid-d.position < 0 %} <td>{{d.grid}}<span>(↓{{(d.grid-d.position)|abs}})</span>
                    </td>
                    {% elif (d.grid-d.position) == 0 %}
                    <td>{{d.grid}}</td>
                    {% else %}
                    <td>{{d.grid}}<span>(↑{{d.grid-d.position}})</span></td>
                    {% endif %}

                    <td>{{d.laps}}</td>

                    {% if d.fastest_lap.rank == 1 %}
                    <td>
                        <span class="bg-green-400">{{d.fastest_lap.time|laptime_format}}</span>
                    </td>
                    {% else %}
                    <td>{{d.fastest_lap.time|laptime_format}}</td>
                    {% endif %}

                    <!-- <td>{{d.time.time}}</td> -->
                    <td>{{d.status|race_status}}</td>
                    <td>{{d.points|int}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {{ sh.section_header(race.race_name + " - Qualifying") }}

    <table class="text-xs table-fixed mx-auto text-left" style="border-collapse: separate;
    border-spacing: 12px 3px;">
        <thead class="text-left">
            <tr>
                <th>Pos</th>
                <th>Driver</th>
                <th>Constructor</th>
                <th>Quali 1</th>
                <th>Quali 2</th>
                <th>Quali 3</th>
            </tr>
        </thead>
        <tbody>
            {% for d in quali.qualifying_results %}
            <tr>
                <td>{{d.position}}</td>
                <td>
                    <a href="{{url_for('driver', driver_id=d.driver.driver_id)}}">
                        {{d.driver.given_name + " " + d.driver.family_name}}
                    </a>
                </td>
                <td><a
                        href="{{url_for('constructor', constructor_id=d.constructor.constructor_id)}}">{{d.constructor.name}}</a>
                </td>
                {% if d.qual_1 == None %}
                <td></td>
                {% else %}
                <td>{{d.qual_1|laptime_format}}</td>
                {% endif %}

                {% if d.qual_2 == None %}
                <td></td>
                {% else %}
                <td>{{d.qual_2|laptime_format}}</td>
                {% endif %}

                {% if d.qual_3 == None %}
                <td></td>
                {% else %}
                <td>{{d.qual_3|laptime_format}}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endblock %}